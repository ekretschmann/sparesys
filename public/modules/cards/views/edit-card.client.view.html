<section data-ng-controller="CardsController" data-ng-init="findOne()">

<div ng-include="'/modules/cards/views/partial/delete-card.modal.client.view.html'"></div>
<div ng-include="'/modules/cards/views/partial/manage-images.modal.client.view.html'"></div>

<div class="content-header">
    <div class="pull-right">

        <div class="submenu">

            <div ng-include="'/modules/cards/views/partial/edit-card-menu.client.view.html'"></div>

        </div>
    </div>

    <div class="title">
        {{card.question}}
    </div>
    <div class="headerinfo">
        <table>
            <!--<tr>-->
            <!--<td>{{card.answer}}</td>-->
            <!--<td class="left-padded"></td>-->
            <!--<td class="left-padded">-->
            <!--</td>-->
            <!--</tr>-->
            <tr>
                <td>Pack: <a href="" data-ng-click="navigateToPack(pack)">{{pack.name}}</a>
                </td>
            </tr>


            <tr>
                <td class="left-padded">

                    <span data-ng-if="prevCard">
                        <a class="right-padded-m" data-ng-href="#!/cards/{{prevCard._id}}/edit">prev</a>
                    </span>

                    <span data-ng-if="nextCard">
                    <a data-ng-href="#!/cards/{{nextCard._id}}/edit">next</a>
                    </span>

                </td>
            </tr>


        </table>


    </div>
</div>
<form class="form-horizontal" data-ng-submit="update()" novalidate>
<fieldset>


<table>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded">ID</td>
    <td class="expands  bottom-spacer">
        {{card._id}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded">User</td>
    <td class="expands  bottom-spacer">
        {{card.user}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded">Slaves</td>
    <td class="expands  bottom-spacer">
        {{card.slaves}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded">Master</td>
    <td class="expands  bottom-spacer">
        {{card.master}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded">Course</td>
    <td class="expands  bottom-spacer">
        {{card.course}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded nowrap">Supervisor</td>
    <td class="expands  bottom-spacer">
        {{card.supervisor}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded">Valid Answers</td>
    <td class="expands  bottom-spacer">
        {{card.validanswers}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded">Invalid Answers</td>
    <td class="expands  bottom-spacer">
        {{card.invalidanswers}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded nowrap">Valid Reverse Answers</td>
    <td class="expands  bottom-spacer">
        {{card.validreverseanswers}}
    </td>
</tr>

<tr class="bottom-spacer" data-ng-if="authentication.user.roles.indexOf('debug-viewer') !== -1">
    <td class="right-padded nowrap">Invalid Reverse Answers</td>
    <td class="expands  bottom-spacer">
        {{card.invalidreverseanswers}}
    </td>
</tr>


<tr>
    <td class="right-padded-m">Mode</td>
    <td>
        <div class="btn-group">
            <button type="button"
                    class="btn btn-default">{{ card.type }}
            </button>
            <button type="button"
                    class="btn btn-default dropdown-toggle">
                <span class="caret"></span>
                <span class="sr-only">Split button!</span>
            </button>
            <ul class="dropdown-menu" role="menu">
                <li data-ng-repeat="t in cardtypes"><a
                        data-ng-click="setCardType(t)">{{t}}</a></li>
            </ul>
        </div>
    </td>
</tr>

<!--<tr data-ng-if="card.type === 'image-text'">-->
<!--<td class="top-aligned nowrap">Images Front</td>-->

<!--<td data-ng-if="card.images  === 0">-->

<!--no images-->
<!--</td>-->

<!--<td>-->

<!--<table>-->
<!--<tr>-->
<!--<td class="right-padded-m" data-ng-repeat="img in card.images">-->
<!--<img ng-src="{{img}}" style="max-width: 128px; max-height: 128px;"/>-->
<!--</td>-->
<!--</tr>-->
<!--</table>-->
<!--</td>-->

<!--</tr>-->

<tr>
    <td class="right-padded-m nowrap top-padded-s">
        <section data-ng-if="card.type ==='text-text'">
            Front Text
        </section>

        <!--<section data-ng-if="card.type ==='image-text'">-->
        <!--<section data-ng-if="sound === 'yes'">-->
        <!--Read out loud-->
        <!--</section>-->

        <!--<section data-ng-if="sound === 'no'" class="text-muted">-->
        <!--Read out loud-->
        <!--</section>-->
        <!--</section>-->

    </td>
    <td class="expands right-padded-m top-padded-s">
        <section data-ng-if="sound === 'yes' || card.type === 'text-text'">
            <input type="text"

                   data-ng-model="card.question"
                   id="question"
                   class=" form-control focus standard-input-width"
                   placeholder="Question"
                   data-ng-blur="update()"
                   required>
        </section>

        <section data-ng-if="sound === 'no' && card.type === 'image-text'"
                 class="text-muted nowrap standard-input-width">
            no text being read
        </section>
    </td>
    <td class="nowrap">

                    <span class="right-padded-s">
                    Read out Loud
                        </span>

        <div class="btn-group right-padded-m">

            <button type="button" class="btn btn-default" style="width: 60px">{{ sound }}</button>
            <button type="button" class="btn btn-default dropdown-toggle">
                <span class="caret"></span>
                <span class="sr-only">Split button!</span>
            </button>
            <ul class="dropdown-menu" role="menu">
                <li data-ng-repeat="r in readQuestions"><a
                        data-ng-click="setSound(r)">{{r}}</a>
                </li>
            </ul>
        </div>
    </td>

</tr>


<tr data-ng-if="card.bothways === true" data-ng-repeat="alt in card.alternativequestions track by $index">
    <td class="right-padded"></td>
    <td class="expands">
        <input type="text"
               data-ng-model="alt"
               class="form-control standard-input-width "
               data-ng-blur="updateAlternativeQuestion($index, alt)"
               placeholder="Alternative">
    </td>
</tr>

<tr class="controls" data-ng-if="card.bothways">
    <td class="right-padded-m top-padded-s"></td>
    <td class="expands right-padded-m top-padded-s">
        <input type="text"
               data-ng-model="nextAlternativeQuestion.text"
               id="alternativequestion"
               class="standard-input-width form-control alternative"
               ng-keyup="enterAlternativeQuestion($event)"
               placeholder="Next Alternative (when asked back to front)"
               data-ng-blur="updateNextAlternativeQuestion()">
    </td>
</tr>

<tr>
    <td class="right-padded">Back</td>

    <td class="expands">
        <table>
            <tr>
                <td class="right-padded">
                    <input type="text"
                           data-ng-model="card.answer"
                           id="answer"
                           class="standard-input-width form-control"
                           placeholder="Answer"
                           data-ng-blur="updateAnswer()"
                           required>
                </td>

                <td class="nowrap">
                    Read:

                    <div class="btn-group  bottom-spacer">
                        <button type="button" class="btn btn-default" style="width: 60px">{{ soundback }}</button>
                        <button type="button" class="btn btn-default dropdown-toggle">
                            <span class="caret"></span>
                            <span class="sr-only">Split button!</span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li data-ng-repeat="r in readAnswers"><a
                                    data-ng-click="setSoundBack(r)">{{r}}</a>
                            </li>
                        </ul>
                    </div>
                </td>
            </tr>
        </table>


</tr>


<tr data-ng-repeat="alt in card.alternatives track by $index">
    <td class="right-padded"></td>
    <td class="expands">
        <input type="text"
               data-ng-model="alt"
               id="alternatives"
               class="standard-input-width form-control"
               data-ng-blur="updateAlternative($index, alt)"
               placeholder="Alternative Answer">
    </td>
</tr>

<tr class="controls">
    <td class="right-padded"></td>
    <td class="expands">
        <input type="text"
               data-ng-model="nextAlternative"
               id="alternative"
               class="standard-input-width form-control alternative"
               ng-keyup="enterAlternative($event)"
               placeholder="Next Alternative"
               data-ng-blur="updateNextAlternative()">
    </td>
</tr>


<tr>
    <td class="right-padded">Checks</td>
    <td>
        <div class="btn-group bottom-spacer">
            <button type="button"
                    class="btn btn-default">{{ validation }}
            </button>
            <button type="button"
                    class="btn btn-default dropdown-toggle">
                <span class="caret"></span>
                <span class="sr-only">Split button!</span>
            </button>
            <ul class="dropdown-menu" role="menu">
                <li data-ng-repeat="val in validations"><a
                        data-ng-click="setValidation(val)">{{val}}</a></li>
            </ul>
        </div>
    </td>
</tr>


<tr>
    <td class="right-padded">
        <section data-ng-if="card.type === 'text-text'">
            Direction
        </section>
        <section data-ng-if="card.type === 'image-text'" class="text-muted">
            Direction
        </section>
    </td>
    <td>
        <section data-ng-if="card.type === 'text-text'">
            <div class="btn-group  bottom-spacer">
                <button type="button" class="btn btn-default">{{ direction }}</button>
                <button type="button" class="btn btn-default dropdown-toggle">
                    <span class="caret"></span>
                    <span class="sr-only">Split button!</span>
                </button>
                <ul class="dropdown-menu" role="menu">
                    <li data-ng-repeat="d in directions"><a data-ng-click="setDirection(d)">{{d}}</a>
                    </li>
                </ul>
            </div>
        </section>

        <section data-ng-if="card.type === 'image-text'" class="text-muted">
            <div class="btn-group  bottom-spacer">
                <button type="button" class="btn btn-default.disabled text-muted">{{ direction }}</button>
                <button type="button" class="btn btn-default.disabled dropdown-toggle">
                    <span class="caret"></span>
                    <span class="sr-only">Split button!</span>
                </button>

            </div>
        </section>
    </td>
</tr>

<tr data-ng-controller="DateDropdownController">
    <td>Due date</td>
    <td>

        <div class="input-group bottom-spacer">
            <input type="text"
                   class="form-control"
                   datepicker-popup="{{format}}"
                   ng-model="$parent.card.due"
                   is-open="opened"
                   min-date="minDate"
                   datepicker-options="dateOptions"
                   date-disabled="disabled(date, mode)"
                   ng-required="false"
                   close-text="Close"
                   data-ng-blur="$parent.update()"/>

            <div class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="open($event)"><i
                        class="glyphicon glyphicon-calendar"></i></button>
            </div>
        </div>

    </td>
</tr>

<tr data-ng-controller="DateDropdownController">
    <td>Start date</td>
    <td>

        <div class="input-group  bottom-spacer">
            <input type="text"
                   class="form-control"
                   datepicker-popup="{{format}}"
                   ng-model="$parent.card.after"
                   is-open="opened" min-date="minDate"
                   datepicker-options="dateOptions"
                   date-disabled="disabled(date, mode)"
                   ng-required="false"
                   close-text="Close"
                   data-ng-blur="$parent.update()"/>

            <div class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="open($event)"><i
                        class="glyphicon glyphicon-calendar"></i></button>
            </div>
        </div>

    </td>
</tr>


</table>


</fieldset>


</form>
<div data-ng-show="error" class="text-danger" style="text-align: center">
    <strong>Error: {{error}}</strong>
</div>

<div class="footer">

    <div>
        <small>
            <em class="text-muted">Created on {{card.created | date:'medium'}}</em>
        </small>
    </div>
    <div data-ng-if="card.updated">
        <small>
            <em class="text-muted">Updated on {{card.updated | date:'medium'}}</em>
        </small>
    </div>

</div>
</section>