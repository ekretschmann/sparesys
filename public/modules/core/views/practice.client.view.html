<section data-ng-controller="PracticeController" data-ng-init="initPractice()">


    <div class="content-header">
        <div class="title">
            {{course.name}}
        </div>
        <div class="headerinfo">
            <table class="info expands">
                <tr>
                    <td>Description</td>
                    <td class="left-padded-s">:</td>
                    <td class="left-padded-s nowrap">{{course.description}}</td>
                </tr>


                <tr>
                    <td>Cards</td>
                    <td class="left-padded-s">:</td>
                    <td class="left-padded-s">
                        <span data-ng-if="cards">{{cards.length}}</span>
                        <span data-ng-if="!cards">0</span>
                    </td>

                    <td class="expands"></td>

                    <td>Score</td>
                    <td class="left-padded-s">:</td>
                    <td class="left-padded-s">
                        <span data-ng-if="cards">{{ cardScore }}</span>
                        <span data-ng-if="!cards">0</span>

                    </td>

                </tr>

                <tr>
                    <td>In Play</td>
                    <td class="left-padded-s">:</td>
                    <td class="left-padded-s">
                        <span data-ng-if="cards">{{inPlay}}</span>
                        <span data-ng-if="!cards">0</span>
                    </td>

                    <td class="expands"></td>


                    <td>Mode</td>
                    <td class="left-padded-s">:</td>
                    <td class="left-padded-s">
                        <span data-ng-if="cards">{{mode}}</span>

                    </td>
                </tr>

                <tr>
                    <td class="nowrap" ng-style="doneColorCode" data-ng-if="doneScore">Done Score</td>
                    <td class="nowrap" ng-style="doneColorCode" data-ng-if="!doneScore"></td>
                    <td class="left-padded-s" ng-style="doneColorCode" data-ng-if="doneScore">:</td>
                    <td class="left-padded-s" ng-style="doneColorCode" data-ng-if="!doneScore"></td>
                    <td class="left-padded-s" ng-style="doneColorCode" data-ng-if="doneScore">
                        {{doneScore}}
                    </td>
                    <td class="left-padded-s" ng-style="doneColorCode" data-ng-if="!doneScore"></td>

                    <td class="expands"></td>


                    <td>Retention</td>
                    <td class="left-padded-s">:</td>
                    <td class="left-padded-s">
                        {{card.retention}}%

                    </td>
                </tr>

            </table>
        </div>
    </div>

    <div data-ng-if="cards && cards.length > 0" class="position:relative"  >



            <div data-ng-show="mode === 'forward'" data-ng-hide="mode !== 'forward'" style="height: 500px">

                <div data-ng-show="assess === 'self'" data-ng-hide="assess === 'auto'">
                    <div ng-include="'/modules/core/views/partial/forward-self.client.view.html'"></div>
                </div>
                <div data-ng-show="assess === 'auto'" data-ng-hide="assess === 'self'">
                    <div ng-include="'/modules/core/views/partial/forward-auto.client.view.html'"></div>
                </div>
            </div>

            <div data-ng-show="mode === 'reverse'" data-ng-hide="mode !== 'reverse'" style="height: 500px">
                <div data-ng-show="assess === 'self'" data-ng-hide="assess === 'auto'">
                    <div ng-include="'/modules/core/views/partial/reverse-self.client.view.html'"></div>
                </div>

                <div data-ng-show="assess === 'auto'" data-ng-hide="assess === 'self'">
                    <div ng-include="'/modules/core/views/partial/reverse-auto.client.view.html'"></div>
                </div>
            </div>

            <div data-ng-show="mode === 'images'" data-ng-hide="mode !== 'images'" style="height: 500px">


                <div data-ng-show="assess === 'self'" data-ng-hide="assess === 'auto'">

                    <div ng-include="'/modules/core/views/partial/images-self.client.view.html'"></div>
                </div>

                <div data-ng-show="assess === 'auto'" data-ng-hide="assess === 'self'">
                    <div ng-include="'/modules/core/views/partial/images-auto.client.view.html'"></div>
                </div>


            </div>
        <!--</div>-->


        <div data-ng-show="authentication.user.roles.indexOf('receive-rewards') > -1" data-ng-controller="RewardsController">

            <!--<div style="height: 500px">-->
                <div data-ng-show="mode === 'reward'" data-ng-hide="mode !== 'reward'" style="height: 500px">

                    <div ng-include="'/modules/core/views/partial/rewards.client.view.html'"></div>
                </div>
            <!--</div>-->

            <div>
                <div>{{authentication.user.inventory}}</div>
                <div>{{possibleRecipes}}</div>
            </div>
        </div>
    </div>


    <div data-ng-if="!cards || cards.length === 0">
        <infobox logo="man" position="right">

            There are no cards in this course. You will have to create some in order to practice. You
            can do this by going to your home page (click on Rememberators on the top of this screen)
            and select the edit action for this course or simply <a data-ng-href="#!/courses/{{course._id}}/edit">follow
            this link</a>.


        </infobox>
    </div>


    <section data-ng-if="authentication.user.roles.indexOf('debug-viewer') > -1">


        <table class="table-striped top-margin-l top-padded-l card-border-top" data-ng-if="cards.length > 0">
            <thead>
            <tr>

                <th class="right-padded-m  top-padded-sm">Question</th>
                <th class="right-padded-m center-aligned top-padded-sm nowrap">Predicted Retention [hrs]</th>
                <th class="right-padded-m center-aligned top-padded-sm nowrap">Score</th>
                <th class="right-padded-m center-aligned top-padded-sm nowrap">History</th>


            </tr>
            </thead>
            <tbody>

            <tr>


            <tr data-ng-repeat="card in cards">


                <td class="right-padded-m standard-min-width top-padded top-aligned text-min-width">

                    <a ng-class="checkForward(card)" data-ng-href="#!/cards/{{card._id}}/edit">{{card.question}}</a>
                </td>


                <td class="right-padded-m nowrap center-aligned top-aligned">


                    <div data-ng-if="card.hrt">
                        <!--{{toHours(card.hrt)}}-->
                        {{toHours(card.hrt)}} hrs
                        ({{toSeconds(card.hrt)}} s)
                    </div>

                    <div data-ng-if="!card.hrt">
                        n/a
                    </div>
                </td>

                <td class="right-padded-m nowrap center-aligned top-aligned">


                    {{ round(card.score)}}
                </td>

                <td class="text-muted right-padded-m nowrap center-aligned top-aligned">

                    <div data-ng-repeat="h in card.history">
                        {{toDate(h.when) | date:'d/M h:mm:ss'}}
                    </div>
                </td>


            </tr>

            </tbody>
        </table>

        <div class="center-aligned top-padded-m">
            <button class="btn btn-rememberators" data-ng-click="clearHistory(card)">Clear Card History</button>
            <button class="btn btn-rememberators" data-ng-click="clearCourseHistory()">Clear Course History</button>

        </div>
    </section>
</section>
