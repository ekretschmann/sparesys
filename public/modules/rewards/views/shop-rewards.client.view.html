<section data-ng-controller="RewardsShopController" data-ng-init="find()">


    <!--<div ng-include="'/modules/rewards/views/partial/delete-reward.modal.client.view.html'"></div>-->


    <div class="col-xs-12 col-md-6  " data-ng-if="authentication.user.roles.indexOf('help') > -1">
        <div class="virtual-card font-large">
            <div class="title">Rewards Shop</div>
            <div class="flashcard-section">

                <infobox logo="boy" position="left">
                    <div>
                        Welcome to the Rewards Shop. Here you can spend trophies
                        for things that you can use as ingredients to craft bigger
                        prices.

                    </div>
                </infobox>

            </div>
        </div>
    </div>

    <div class="col-xs-12 col-md-6  ">
        <div class="virtual-card font-large">
            <div class="title">Your Inventory</div>
            <div class="col-md-4">
                <div class="flashcard-section" style="padding-left: 0">

                    <div class="field-label">Skills</div>


                    <div data-ng-if="skills.owned.length === 0" class="field-data">
                        none
                    </div>

                    <div data-ng-repeat="skill in skills.owned" class="field-data">
                        {{skill.name}}

                        <!--<div data-ng-repeat="goal in skill.goals">-->
                        <!--{{goal.name}}-->
                        <!--</div>-->
                    </div>


                </div>
                <div class="flashcard-section" style="padding-top: 1em">

                    <div class="field-label">Goals</div>

                    <div data-ng-if="goals.length === 0" class="field-data">
                        none
                    </div>

                    <div data-ng-repeat="goal in goals.owned track by $index" class="field-data hasIngredient">
                       {{goal.name}}

                        <!--<div data-ng-repeat="goal in skill.goals">-->
                        <!--{{goal.name}}-->
                        <!--</div>-->
                    </div>

                    <div data-ng-repeat="goal in goals.challenge track by $index" class="field-data lacksIngredient">
                       {{goal.name}}

                        <!--<div data-ng-repeat="goal in skill.goals">-->
                        <!--{{goal.name}}-->
                        <!--</div>-->
                    </div>

                </div>
            </div>

            <div class="flashcard-section col-md-4">

                <div class="field-label">Items</div>


                <div data-ng-if="items.owned.length === 0" class="field-data">
                    none
                </div>


                <div data-ng-repeat="item in items.owned" ng-if="$even" class="field-data">
                    {{item.amount}} {{item.name}}
                </div>

            </div>

            <div class="flashcard-section col-md-4" style="padding-right:0">

                <div class="field-label">&nbsp;</div>


                <div data-ng-if="items.owned.length === 0" class="field-data">
                    none
                </div>


                <div data-ng-repeat="item in items.owned" ng-if="$odd" class="field-data">
                    {{item.amount}} {{item.name}}
                </div>

            </div>
        </div>
    </div>


    <div class="col-xs-12 col-md-6  ">
        <div class="virtual-card font-large">
            <!--<div class="title"></div>-->
            <div class="flashcard-section">


                <div class="field-label" style="padding-bottom: 1em">You have {{authentication.user.trophies}} trophies.
                    You can buy:
                </div>


                <div data-ng-repeat="skill in skills.forSale track by $index" class="field-data">

                    <div data-ng-if="authentication.user.trophies >= skill.price">
                        <a href="" data-ng-click="purchase(skill)"><i class="glyphicon glyphicon-piggy-bank"></i></a>
                        New skill: {{skill.name}} ({{skill.price}} <span
                            data-ng-if="skill.price === 1">trophy</span><span
                            data-ng-if="skill.price > 1">trophies</span>)


                    </div>
                    <div data-ng-if="authentication.user.trophies < skill.price" class="text-muted">
                        <i class="glyphicon glyphicon-piggy-bank"></i>
                        New skill: {{skill.name}} ({{skill.price}} <span
                            data-ng-if="skill.price === 1">trophy</span><span
                            data-ng-if="skill.price > 1">trophies</span>)
                    </div>
                </div>


                x{{items.forSale}}x
                <div data-ng-repeat="item in items.forSale track by $index" class="field-data">

                    <div data-ng-if="authentication.user.trophies >= item.price">
                        <a href="" data-ng-click="purchase(item)"><i class="glyphicon glyphicon-piggy-bank"></i></a>
                        {{item.name}} ({{item.price}} <span data-ng-if="item.price === 1">trophy</span><span
                            data-ng-if="item.price > 1">trophies</span>)
                    </div>
                    <div data-ng-if="authentication.user.trophies < item.price" class="text-muted">
                        <i class="glyphicon glyphicon-piggy-bank"></i>
                        {{item.name}} ({{item.price}} <span data-ng-if="item.price === 1">trophy</span><span
                            data-ng-if="item.price > 1">trophies</span>)
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xs-12 col-md-6  ">
        <div class="virtual-card font-large">
            <!--<div class="title">You can build</div>-->
            <div class="flashcard-section">

                <div class="field-label" style="padding-bottom: 1em">You can build:</div>


                <div data-ng-if="recipies.forSale.length === 0" class="field-data">
                    nothing
                </div>

                <div data-ng-repeat="recipe in recipies.forSale">

                    <span class="field-data">
                    <a href="" data-ng-click="craft(recipe)"><i class="glyphicon glyphicon-piggy-bank"></i></a> {{recipe.name}}
                    </span>

                    <span class="field-data">
                    (<span data-ng-repeat="ingredient in recipe.ingredients">{{ingredient.amount}} {{ingredient.name}}<span
                            data-ng-if="!$last">, </span></span>)
                    </span>

                </div>


            </div>
        </div>
    </div>


    <div class="col-xs-12 col-md-6  ">
        <div class="virtual-card font-large">
            <div class="title">Items Dictionary</div>


            <div class="flashcard-section">

                <infobox logo="guru" position="left">
                    <div>
                        There are plenty of items that you can craft. Use this search to find
                        out more of what you can build out of what materials.
                    </div>
                </infobox>

            </div>

            <div class="flashcard-section">


                <div class="col-xs-12">
                    <div class="field-label">Find Items</div>
                    <input type="text"
                           ng-model="options.searchText"
                           class="form-control search"
                           data-ng-change="updateSearch()"
                           placeholder="Name">
                </div>

            </div>

        </div>
    </div>

    <div data-ng-repeat="reward in searchResult">
        <div class="col-xs-6 dashboard-col">
            <div class="virtual-card font-large">
                <div class="title">
                    {{reward.name}}
                </div>

                <div class="flashcard-section">
                    <div class="field-label">
                        {{reward.type}}
                    </div>
                    <div class="field-data">
                        <div data-ng-if="reward.description && reward.description.length>0">{{reward.description}}</div>
                        <div data-ng-if="!reward.description || reward.description.length===0">No description
                            available
                        </div>
                    </div>
                </div>

                <div class="flashcard-section" data-ng-if="reward.type ==='Recipe'">
                    <div class="field-label">Ingredients</div>
                    <div data-ng-repeat="ingredient in reward.ingredients" class="field-data">

                        <div data-ng-if="hasIngredients[ingredient.name] >= ingredient.amount">
                            <a class="hasIngredient" href="" data-ng-click="search(ingredient.name)">{{ingredient.amount}}
                                {{ingredient.name}}</a>
                        </div>

                        <div data-ng-if="!(hasIngredients[ingredient.name] >= ingredient.amount)">
                            <a class="lacksIngredient" href="" data-ng-click="search(ingredient.name)">{{ingredient.amount}}
                                {{ingredient.name}}</a>
                        </div>
                    </div>

                </div>
                <div class="flashcard-section col-xs-6" style="padding-left: 0; padding-right: 0"
                     data-ng-if="reward.enables.length>0">
                    <div class="field-label">Enables</div>


                    <div data-ng-repeat="enabled in reward.enables" class="field-data">
                        {{enabled}}
                    </div>
                </div>

                <div class="flashcard-section col-xs-6" style="padding-left: 0; padding-right: 0"
                     data-ng-if="reward.goals.length>0">
                    <div class="field-label">Goals</div>


                    <div data-ng-repeat="goal in reward.goals" class="field-data">
                        {{goal}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="rememberators-footer col-xs-12" style="margin-top: 3em">rememberators.com</div>

</section>
